# CMGN: a conditional molecular generation net to design target-specific molecules with desired properties


### Abstract

large-scale pre-training(fragments, properties) + fine-tuning with specified/pre-defined targets

→ fragment-to-lead 과정 & multi-objective lead optimization

inverse drug design : generative NN로 specific property에서 novel molecule sampling

**a bidirectional & autoregressive transformer (BART) 사용**

## Introduction

- high-quality drug candidates with desired properties for specific targets
(biological activity, drug-likeness, chemical property)
    
    chemical space를 위해 효율적인 방법 필요 
    
    → generative models은 probability distribution learning & sampling 가능!
    
    Deep generative model(RNN, VAE, GAN)을 이용해서 valid & novel structure generation
    
- Transformer models - SMILES 기반 molecular representation + desired properties
    - conditional transformer인 (RNN + RL) → multiple constraint 만족
    - transformer decoder를 masked SA를 사용해 train → druglike molecules 생성
    
    그래도 specific target, pre-defined druglike properties에 대한 biological activity를 가진 분자 생성 어려움.
    
- CMGN 제안 : BART 기반, bioactive compounds의 chemical space
    - large-scale pretraining for molecular understanding
        
        fragment, molecular properties(MW, logP, QED, SA)가 trained
        (**목적** : primary molecules recover, SPR(Structure-Properties Relationships) 학습)
        
    - fine-tuning on different datasets
    - multi-objective lead optimization for inhibitors of **BTK**(Bruton’s tyrosine kinase)
    
    → Transfer learning + Conditional molecular generation
    
    → fragment-to-lead & multi-objective lead optimization
    

## Materials and methods

### Dataset preparation & representation

- **ZINC → pre-training**
- Druglike molecules → subset of the ChEMBL dataset (filtered by QED value with a threshold of 0.5)
- Protein kinase inhibitors (PKIs), BTK and PAK1 inhibitors  - ChEMBL
- RECAP and BRICS methods : cut the original molecules into fragments 에 사용 → original molecules 제거됨.
    
    RECAP (Retrosynthetic Combinatorial Analysis Procedure)와 BRICS (Breaking of Retrosynthetically Interesting Chemical Substructures)는 화학 분자를 더 작은 구조적 단위, 즉 프래그먼트(fragment)로 분해하는 데 사용되는 두 가지 잘 알려진 방법론입니다. 이 프래그먼트들은 약물 발견에서 구조적 다양성을 탐색하고 새로운 화합물을 설계하는 데 사용됩니다.
    
    1. **RECAP**:
        - RECAP은 복잡한 화학 구조를 더 작은 구조로 분해하는 방법을 제공합니다.
        - 이 방법은 역합성(retrosynthesis) 원리에 기초하여 화합물을 가능한 합성 경로에 따라 분해합니다.
        - RECAP은 주로 화합물의 분자 내에서 화학적으로 안정한 결합들을 유지하면서, 대부분의 합성 가능한 화학 반응을 통해 형성될 수 있는 결합을 분해합니다.
        - 분해되는 위치는 보통 에스테르(ester), 아미드(amide), 에테르(ether)와 같은 일반적인 작용기(functional group) 내의 결합입니다.
        - RECAP 방법론은 약물 설계에서 공통적인 구조적 모티프를 식별하고, 새로운 화합물 라이브러리를 구축하는 데 유용합니다.
    2. **BRICS**:
        - BRICS 역시 분자를 분해하는 방법론이지만, 더 정교한 규칙을 기반으로 합니다.
        - 이 방법은 특정 결합을 '분해 가능한' 것으로 분류하며, 이러한 결합은 주로 'Retrosynthetically Interesting Chemical Substructures'에 해당합니다.
        - BRICS는 16가지의 반응 중심을 식별하여, 이들 위치에서 화합물을 분해하고 각각의 프래그먼트에 연결 지점을 할당합니다.
        - 이 연결 지점은 나중에 새로운 화합물을 합성할 때 다른 프래그먼트와 조합될 수 있는 잠재적 결합 위치를 나타냅니다.
        - BRICS 방법론은 특히 분자의 복잡성을 감소시키고, 새로운 화합물을 발견하는 과정에서 화학적 다양성을 증가시키는 데 유용합니다.
    
    두 방법은 분자를 프래그먼트로 분해하고 이를 재조합하여 신규 화합물을 발견하는 분야, 특히 가상 스크리닝(virtual screening)이나 분자 도킹(molecular docking) 연구에 있어 중요합니다.
    

→ 49 929 577 molecules for pre-training
(973 983 druglike molecules, 37 933 PKIs, 1806 BTK inhibitors)

**+) 219 PAK1 inhibitors for fine-tuning (randomly split - 9:1)**

- SMILES string(chemical structure, fragments) → NLP string으로 토큰화
    - SMILES string expansion : leading token <SMILES> - lagging token </SMILES>
    - fragment SMILES string expansion
    - property ranges - MW, QED, LogP, SA

### Model architecture

6 Encoder layers + 12 attention heads

6 Decoder layers + 12 attention heads

768-dimensional hidden units

- AdamW optimizer + batch size(32)
- 2 epochs CMGN pre-train + 20 epochs CMGN-DL + 나머지는 200 epochs

### Evaluation settings

- Same fragment fraction (SFF): percentage of molecules that contain the input fragment.
    
    SFF = molecules with predefined fragment generated molecules
    
- Recovery: percentage of original molecules generated among test set compounds.
    
    Recovery = target molecules generated target molecules
    
- MOSES metrics (Validity, Uniqueness, Novelty, Internal diversity)

## Results and discussion

### CMGN approach

Quality and properties of molecules generated by CMGN models

Evaluation of the TL strategy for generating molecules for specific targets

Quality and properties of generated molecules of CMGN-DL models with different input conditions

Capacity of CMGN-DL to control molecular properties in the process of molecular generation

Evaluation of the capacity of CMGN-DL to control user-defined molecular properties

Generation based on multiple user-defined molecular properties

Evaluation of effectiveness of the TL strategy and property-guided fragment growing methods of CMGN for target-specific task

Fragment-to-lead case study

Multi-objective parameter optimization of BTK inhibitors

### The advantages of CMGN

- Fragment-Based Drug Discovery & Lead optimization
    
    → 모델의 input이 되는 fragments의 diversity & flexibility 중요
    
    → training model의 molecular fragments 중요
    

생성 모델 간의 차이점 : cutting algorithm, (input) fragments의 수

- 이전 생성 모델
    - SyntaLinker : MMP method(3개 fragments로 분자 자르기). 2개 fragments를 input으로 받아 완전한 분자 생성.
    - MolGPT : Bermis-Murcko scaffolds(RDkit 사용, 1개 fragment만 추출하여 input으로)
    
    → 1~3개의 fragments가 model의 input으로 들어가기 위해 random하게 결정됨.
    
- CMGN은 fragment의 수를 고정시킬 필요 없고 다양한 (input) fragment size를 가질 수 있음. → flexible input

## Conclusion

Transfer Learning을 통해 target-specific molecules + desired properties 생성 문제 해결

- TL은 large-scale molecules로 pre-training을 시키고 target-specific dataset으로 fine-tuning
- **model input** : molecular fragments, properties → recover 원래 molecule
- Evaluation : TL strategy와 property-guided 능력 검증
- GuacaMol dataset으로 CMGN의 property control 능력 테스트 - MW, SA, logP
- fragment-to-lead & multi-objective parameter optimization of BTK inhibitors에 좋은 성능